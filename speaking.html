<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speaking Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 42px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 18px;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .level-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .level-btn {
            padding: 15px 30px;
            border: 3px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
        }

        .level-btn.active {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .level-btn:hover {
            transform: translateY(-2px);
        }

        .word-display {
            background: linear-gradient(135deg, #f0f4ff 0%, #e8ecff 100%);
            padding: 50px;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 30px;
            border: 3px solid #667eea;
        }

        .word-text {
            font-size: 64px;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 15px;
            letter-spacing: 2px;
        }

        .word-phonetic {
            font-size: 24px;
            color: #764ba2;
            font-style: italic;
            margin-bottom: 10px;
        }

        .word-meaning {
            font-size: 18px;
            color: #555;
            margin-top: 15px;
        }

        .controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .mic-button {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-size: 50px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
            position: relative;
        }

        .mic-button:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
        }

        .mic-button.listening {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 8px 20px rgba(231, 76, 60, 0.4);
            }
            50% { 
                transform: scale(1.1); 
                box-shadow: 0 12px 35px rgba(231, 76, 60, 0.6);
            }
        }

        .play-button {
            padding: 15px 40px;
            background: white;
            border: 3px solid #667eea;
            color: #667eea;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            font-size: 18px;
            transition: all 0.3s;
        }

        .play-button:hover {
            background: #667eea;
            color: white;
        }

        .feedback {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #ddd;
            margin-bottom: 30px;
        }

        .feedback-text {
            font-size: 20px;
            color: #555;
            font-weight: 500;
            width: 100%;
        }

        .feedback.correct {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-color: #28a745;
        }

        .feedback.correct .feedback-text {
            color: #155724;
            font-weight: bold;
        }

        .feedback.incorrect {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-color: #dc3545;
        }

        .feedback.incorrect .feedback-text {
            color: #721c24;
            font-weight: bold;
        }

        .navigation {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .nav-btn {
            flex: 1;
            max-width: 200px;
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
        }

        .nav-btn.prev {
            background: #95a5a6;
            color: white;
        }

        .nav-btn.prev:hover {
            background: #7f8c8d;
        }

        .nav-btn.next {
            background: #667eea;
            color: white;
        }

        .nav-btn.next:hover {
            background: #764ba2;
        }

        .progress {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 16px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f0f4ff 0%, #e8ecff 100%);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #667eea;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
        }

        @media (max-width: 600px) {
            .word-text {
                font-size: 48px;
            }

            .mic-button {
                width: 100px;
                height: 100px;
                font-size: 40px;
            }

            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéôÔ∏è Speaking Practice</h1>
            <p>Improve your pronunciation with AI-powered feedback</p>
        </div>

        <div class="content">
            <div class="level-selector">
                <button class="level-btn active" onclick="selectLevel('beginner')">Beginner</button>
                <button class="level-btn" onclick="selectLevel('intermediate')">Intermediate</button>
                <button class="level-btn" onclick="selectLevel('advanced')">Advanced</button>
            </div>

            <div class="word-display">
                <div class="word-text" id="wordText">Hello</div>
                <div class="word-phonetic" id="wordPhonetic">/h…ôÀàlo ä/</div>
                <div class="word-meaning" id="wordMeaning">A greeting used when meeting someone</div>
            </div>

            <div class="controls">
                <button class="play-button" onclick="speakWord()">üîä Listen</button>
                <button class="mic-button" id="micButton" onclick="toggleListening()">üé§</button>
            </div>

            <div class="feedback" id="feedback">
                <div class="feedback-text" id="feedbackText">Click the microphone and say the word</div>
            </div>

            <div class="navigation">
                <button class="nav-btn prev" onclick="previousWord()">‚Üê Previous</button>
                <button class="nav-btn next" onclick="nextWord()">Next ‚Üí</button>
            </div>

            <div class="progress">
                Word <span id="currentIndex">1</span> of <span id="totalWords">10</span>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="attemptCount">0</div>
                    <div class="stat-label">Attempts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="correctCount">0</div>
                    <div class="stat-label">Correct</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="accuracyPercent">0%</div>
                    <div class="stat-label">Accuracy</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const words = {
            beginner: [
                { word: 'Hello', phonetic: '/h…ôÀàlo ä/', meaning: 'A greeting used when meeting someone' },
                { word: 'Thank you', phonetic: '/Œ∏√¶≈ãk juÀê/', meaning: 'Expression of gratitude' },
                { word: 'Good morning', phonetic: '/…° äd Ààm…îÀêrn…™≈ã/', meaning: 'A greeting used in the morning' },
                { word: 'Please', phonetic: '/pliÀêz/', meaning: 'Polite word when making a request' },
                { word: 'Sorry', phonetic: '/Ààs…ëÀêri/', meaning: 'Expression of apology' },
                { word: 'Yes', phonetic: '/j…õs/', meaning: 'Affirmative response' },
                { word: 'No', phonetic: '/no ä/', meaning: 'Negative response' },
                { word: 'Goodbye', phonetic: '/…° ädÀàba…™/', meaning: 'Farewell expression' },
                { word: 'Water', phonetic: '/Ààw…îÀêt…ôr/', meaning: 'Clear liquid essential for life' },
                { word: 'Food', phonetic: '/fuÀêd/', meaning: 'Substance consumed for nutrition' }
            ],
            intermediate: [
                { word: 'Beautiful', phonetic: '/ÀàbjuÀêt…™f…ôl/', meaning: 'Pleasing to the senses' },
                { word: 'Difficult', phonetic: '/Ààd…™f…™k…ôlt/', meaning: 'Hard to do or understand' },
                { word: 'Restaurant', phonetic: '/Ààr…õst…ôr…ëÀênt/', meaning: 'Place where meals are served' },
                { word: 'Necessary', phonetic: '/Ààn…õs…ôs…õri/', meaning: 'Required or essential' },
                { word: 'Successful', phonetic: '/s…ôkÀàs…õsf…ôl/', meaning: 'Achieving desired aims' },
                { word: 'Technology', phonetic: '/t…õkÀàn…ëÀêl…ôd íi/', meaning: 'Application of scientific knowledge' },
                { word: 'Environment', phonetic: '/…™nÀàva…™r…ônm…ônt/', meaning: 'The natural world around us' },
                { word: 'Communication', phonetic: '/k…ôÀåmjuÀên…™Ààke…™ É…ôn/', meaning: 'Exchange of information' },
                { word: 'Opportunity', phonetic: '/Àå…ëÀêp…ôrÀàtuÀên…ôti/', meaning: 'A favorable situation' },
                { word: 'Important', phonetic: '/…™mÀàp…îÀêrt…ônt/', meaning: 'Of great significance' }
            ],
            advanced: [
                { word: 'Conscientious', phonetic: '/Àåk…ëÀên ÉiÀà…õn É…ôs/', meaning: 'Wishing to do what is right' },
                { word: 'Entrepreneurship', phonetic: '/Àå…ëÀêntr…ôpr…ôÀàn…úÀêr É…™p/', meaning: 'Starting and running businesses' },
                { word: 'Pharmaceutical', phonetic: '/Àåf…ëÀêrm…ôÀàsuÀêt…™k…ôl/', meaning: 'Relating to medicinal drugs' },
                { word: 'Bureaucracy', phonetic: '/bj äÀàr…ëÀêkr…ôsi/', meaning: 'Complex administrative system' },
                { word: 'Deteriorate', phonetic: '/d…™Ààt…™ri…ôre…™t/', meaning: 'To become progressively worse' },
                { word: 'Philosophical', phonetic: '/Àåf…™l…ôÀàs…ëÀêf…™k…ôl/', meaning: 'Relating to the study of knowledge' },
                { word: 'Reconnaissance', phonetic: '/r…™Ààk…ëÀên…™s…ôns/', meaning: 'Military observation of a region' },
                { word: 'Ubiquitous', phonetic: '/juÀêÀàb…™kw…™t…ôs/', meaning: 'Present everywhere' },
                { word: 'Ambiguous', phonetic: '/√¶mÀàb…™…°ju…ôs/', meaning: 'Open to more than one interpretation' },
                { word: 'Perseverance', phonetic: '/Àåp…úÀêrs…ôÀàv…™r…ôns/', meaning: 'Persistence in doing something' }
            ]
        };

        let currentLevel = 'beginner';
        let currentIndex = 0;
        let currentWords = words.beginner;
        let recognition = null;
        let isListening = false;
        let attempts = 0;
        let correct = 0;
        let synthesis = window.speechSynthesis;

        function initializeSpeechRecognition() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                document.getElementById('feedbackText').textContent = 'Speech recognition not supported in this browser. Please use Chrome, Edge, or Safari.';
                document.getElementById('micButton').disabled = true;
                return false;
            }

            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onstart = function() {
                isListening = true;
                document.getElementById('micButton').classList.add('listening');
                document.getElementById('feedbackText').textContent = 'Listening... Speak now!';
                document.getElementById('feedback').className = 'feedback';
            };

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript.toLowerCase().trim();
                const currentWord = currentWords[currentIndex].word.toLowerCase();
                const confidence = event.results[0][0].confidence;
                
                // Debug: Log what was said vs what was expected
                console.log('You said:', transcript);
                console.log('Expected:', currentWord);
                
                attempts++;
                
                // Stricter matching - only accept exact matches or very close matches
                let isCorrect = false;
                
                // For multi-word phrases
                if (currentWord.includes(' ')) {
                    isCorrect = transcript === currentWord || transcript.includes(currentWord);
                } else {
                    // For single words - exact match only
                    isCorrect = transcript === currentWord;
                }
                
                console.log('Is correct?', isCorrect);
                
                if (isCorrect) {
                    correct++;
                    document.getElementById('feedbackText').innerHTML = `
                        <div>
                            <div style="font-size: 28px; margin-bottom: 15px; color: #28a745;">‚úì Perfect! Excellent pronunciation!</div>
                            <div style="font-size: 18px; color: #155724;">You said: "<strong>${transcript}</strong>"</div>
                            <div style="font-size: 16px; margin-top: 10px; opacity: 0.8;">Confidence: ${Math.round(confidence * 100)}%</div>
                        </div>
                    `;
                    document.getElementById('feedback').className = 'feedback correct';
                    setTimeout(() => nextWord(), 2500);
                } else {
                    document.getElementById('feedbackText').innerHTML = `
                        <div>
                            <div style="font-size: 28px; margin-bottom: 15px; color: #dc3545; font-weight: bold;">‚úó WRONG PRONUNCIATION!</div>
                            <div style="font-size: 20px; margin: 15px 0; padding: 15px; background: rgba(255,255,255,0.7); border-radius: 8px;">
                                You said: <strong style="color: #c62828;">"${transcript}"</strong>
                            </div>
                            <div style="font-size: 20px; margin: 15px 0; padding: 15px; background: rgba(255,255,255,0.9); border-radius: 8px; border: 2px solid #28a745;">
                                Correct word is: <strong style="color: #28a745;">"${currentWords[currentIndex].word}"</strong>
                            </div>
                            <div style="font-size: 16px; margin-top: 15px; padding: 12px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                                üí° <strong>Tip:</strong> Click the üîä Listen button to hear the correct pronunciation
                            </div>
                        </div>
                    `;
                    document.getElementById('feedback').className = 'feedback incorrect';
                }
                
                updateStats();
            };

            recognition.onerror = function(event) {
                let errorMsg = 'Error: ';
                switch(event.error) {
                    case 'no-speech':
                        errorMsg += 'No speech detected. Please try again.';
                        break;
                    case 'audio-capture':
                        errorMsg += 'No microphone found. Please check your device.';
                        break;
                    case 'not-allowed':
                        errorMsg += 'Microphone access denied. Please enable it in settings.';
                        break;
                    default:
                        errorMsg += event.error;
                }
                document.getElementById('feedbackText').textContent = errorMsg;
                document.getElementById('feedback').className = 'feedback';
            };

            recognition.onend = function() {
                isListening = false;
                document.getElementById('micButton').classList.remove('listening');
            };

            return true;
        }

        function toggleListening() {
            if (!recognition) {
                if (!initializeSpeechRecognition()) return;
            }

            if (isListening) {
                recognition.stop();
            } else {
                recognition.start();
            }
        }

        function speakWord() {
            if (synthesis.speaking) {
                synthesis.cancel();
            }

            const utterance = new SpeechSynthesisUtterance(currentWords[currentIndex].word);
            utterance.rate = 0.8;
            utterance.pitch = 1;
            utterance.volume = 1;
            synthesis.speak(utterance);
        }

        function selectLevel(level) {
            currentLevel = level;
            currentWords = words[level];
            currentIndex = 0;
            
            document.querySelectorAll('.level-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            updateDisplay();
        }

        function updateDisplay() {
            const word = currentWords[currentIndex];
            document.getElementById('wordText').textContent = word.word;
            document.getElementById('wordPhonetic').textContent = word.phonetic;
            document.getElementById('wordMeaning').textContent = word.meaning;
            document.getElementById('currentIndex').textContent = currentIndex + 1;
            document.getElementById('totalWords').textContent = currentWords.length;
            document.getElementById('feedbackText').textContent = 'Click the microphone and say the word';
            document.getElementById('feedback').className = 'feedback';
        }

        function nextWord() {
            if (currentIndex < currentWords.length - 1) {
                currentIndex++;
            } else {
                currentIndex = 0;
            }
            updateDisplay();
        }

        function previousWord() {
            if (currentIndex > 0) {
                currentIndex--;
            } else {
                currentIndex = currentWords.length - 1;
            }
            updateDisplay();
        }

        function updateStats() {
            document.getElementById('attemptCount').textContent = attempts;
            document.getElementById('correctCount').textContent = correct;
            const accuracy = attempts > 0 ? Math.round((correct / attempts) * 100) : 0;
            document.getElementById('accuracyPercent').textContent = accuracy + '%';
        }

        // Initialize
        updateDisplay();
    </script>
</body>
</html>